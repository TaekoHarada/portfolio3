# Portfolio Website

AWS ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ´»ç”¨ã—ãŸå€‹äººãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆï¼ˆCloud Resume Challengeï¼‰

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CloudFront     â”‚ (CDNãƒ»HTTPSåŒ–)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  S3 Bucket      â”‚ (é™çš„ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°)
â”‚  (Next.js)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ ãŠå•ã„åˆã‚ã›
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway    â”‚ (REST API)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lambda         â”‚ (Node.js)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SES            â”‚ (ãƒ¡ãƒ¼ãƒ«é€ä¿¡)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ è¨ªå•è€…ã‚«ã‚¦ãƒ³ãƒˆ
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DynamoDB       â”‚ (è¨ªå•è€…æ•°ä¿å­˜)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- **Next.js 14** - React ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆé™çš„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼‰
- **TypeScript** - å‹å®‰å…¨æ€§
- **Tailwind CSS** - ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

### AWS ã‚¤ãƒ³ãƒ•ãƒ©

- **S3** - é™çš„ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°
- **CloudFront** - CDNãƒ»ã‚¨ãƒƒã‚¸é…ä¿¡ãƒ»HTTPS åŒ–
- **Lambda** - ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹é–¢æ•°ï¼ˆNode.js 20.xï¼‰
- **API Gateway** - REST API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- **SES** - ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚µãƒ¼ãƒ“ã‚¹
- **DynamoDB** - è¨ªå•è€…æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
- **IAM** - ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **AWS CDK** - Infrastructure as Codeï¼ˆTypeScriptï¼‰

### CI/CD

- **GitHub Actions** - è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- **AWS CLI** - ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–

## ğŸ“‹ å‰ææ¡ä»¶

- Node.js 18.x ä»¥ä¸Š
- npm ã¾ãŸã¯ yarn
- AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- AWS CLI è¨­å®šæ¸ˆã¿
- AWS CDK CLI (`npm install -g aws-cdk`)
- Git

## ğŸš€ ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/TaekoHarada/portfolio3
cd portfolio3
```

### 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

```bash
npm install
```

#### CDKï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ï¼‰

```bash
cd cdk
npm install
cd ..
```

### 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env.local` ã‚’ä½œæˆ:

```env
NEXT_PUBLIC_API_ENDPOINT_CONTACT=https://your-api-id.execute-api.ap-northeast-1.amazonaws.com/prod
NEXT_PUBLIC_API_ENDPOINT_VISITOR=https://your-api-id.execute-api.ap-northeast-1.amazonaws.com/prod
```

### 4. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:3000` ã‚’é–‹ã

### 5. æœ¬ç•ªãƒ“ãƒ«ãƒ‰

```bash
npm run build
```

é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ãŒ `out/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

## ğŸ“¦ ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### ğŸ†• CDKã‚’ä½¿ã£ãŸãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ¨å¥¨ï¼‰

AWS CDKã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ã‚³ãƒ¼ãƒ‰ã§ç®¡ç†ã—ã€å†ç¾å¯èƒ½ãªãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

#### Step 1: AWS CDK CLI ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install -g aws-cdk
```

#### Step 2: AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ï¼ˆåˆå›ã®ã¿ï¼‰

```bash
# ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã‚’ç¢ºèª
aws sts get-caller-identity --query Account --output text

# ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—å®Ÿè¡Œ
cdk bootstrap aws://ACCOUNT-ID/ap-northeast-1
```

#### Step 3: CDKãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰

```bash
cd cdk
npm run build
```

#### Step 4: ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã®ç¢ºèª

```bash
# å·®åˆ†ã‚’ç¢ºèª
cdk diff

# CloudFormationãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆ
cdk synth
```

#### Step 5: ã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
cdk deploy

# ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ 'y' ã‚’å…¥åŠ›
```

#### Step 6: åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥

```bash
# è¨ªå•è€…ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®åˆæœŸå€¤ã‚’è¨­å®š
aws dynamodb put-item \
  --table-name portfolio-visitor-count \
  --item '{"id": {"S": "total"}, "count": {"N": "0"}}' \
  --region ap-northeast-1
```

#### Step 7: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«æˆ»ã‚‹
cd ..

# Next.jsã‚’ãƒ“ãƒ«ãƒ‰
npm run build

# S3ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
aws s3 sync out/ s3://your-portfolio-bucket/ --delete
```

### å¾“æ¥ã®æ–¹æ³•ï¼ˆAWS CLIï¼‰

<details>
<summary>AWS CLIã‚’ä½¿ã£ãŸæ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ï¼ˆã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ï¼‰</summary>

#### Step 1: S3 ãƒã‚±ãƒƒãƒˆã®ä½œæˆ

```bash
aws s3 mb s3://your-portfolio-bucket --region ap-northeast-1
aws s3 website s3://your-portfolio-bucket \
  --index-document index.html \
  --error-document 404.html
```

#### Step 2: ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã®è¨­å®š

```bash
aws s3api put-bucket-policy \
  --bucket your-portfolio-bucket \
  --policy file://bucket-policy.json
```

#### Step 3: ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

```bash
npm run build
aws s3 sync out/ s3://your-portfolio-bucket/ --delete
```

#### Step 4: CloudFront ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ

- ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¾ãŸã¯ AWS CLI ã§ä½œæˆ
- SSL è¨¼æ˜æ›¸ï¼ˆACMï¼‰ã®è¨­å®š
- ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®š

#### Step 5: DynamoDB ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ

```bash
aws dynamodb create-table \
  --table-name portfolio-visitor-count \
  --attribute-definitions \
    AttributeName=id,AttributeType=S \
  --key-schema \
    AttributeName=id,KeyType=HASH \
  --billing-mode PAY_PER_REQUEST \
  --region ap-northeast-1

# åˆæœŸå€¤ã‚’è¨­å®š
aws dynamodb put-item \
  --table-name portfolio-visitor-count \
  --item '{"id": {"S": "total"}, "count": {"N": "0"}}' \
  --region ap-northeast-1
```

#### Step 6: Lambda é–¢æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
cd lambda/contact-handler
npm install
zip -r contact-handler.zip .
aws lambda create-function \
  --function-name contact-handler \
  --runtime nodejs22.x \
  --role arn:aws:iam::ACCOUNT_ID:role/lambda-contact-role \
  --handler index.handler \
  --zip-file fileb://contact-handler.zip
```

#### Step 7: API Gateway ã®è¨­å®š

- REST API ã®ä½œæˆ
- Lambda ã¨ã®çµ±åˆ
- CORS ã®æœ‰åŠ¹åŒ–
- ã‚¹ãƒ†ãƒ¼ã‚¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

#### Step 8: SES ã®è¨­å®š

```bash
aws ses verify-email-identity \
  --email-address your-email@example.com \
  --region ap-northeast-1
```

</details>

## ğŸ—ï¸ CDKãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
cdk/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ cdk.ts              # CDKã‚¢ãƒ—ãƒªã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ cdk-stack.ts        # ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ã‚¿ãƒƒã‚¯å®šç¾©
â”œâ”€â”€ test/
â”‚   â””â”€â”€ cdk.test.ts         # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ cdk.json                # CDKè¨­å®š
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

### ç¾åœ¨CDKã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒªã‚½ãƒ¼ã‚¹

- âœ… **DynamoDB** - è¨ªå•è€…ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«

### ä»Šå¾ŒCDKã§ç®¡ç†äºˆå®šã®ãƒªã‚½ãƒ¼ã‚¹

- â³ **Lambda** - ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹é–¢æ•°
- â³ **API Gateway** - REST APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- â³ **S3 & CloudFront** - é™çš„ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°

## ğŸ”„ CI/CDï¼ˆGitHub Actionsï¼‰

`.github/workflows/deploy.yml` ãŒè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

**ãƒˆãƒªã‚¬ãƒ¼:**

- `main` ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥

**å®Ÿè¡Œå†…å®¹:**

1. Next.js ã®ãƒ“ãƒ«ãƒ‰
2. S3 ã¸ã®ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸ
3. CloudFront ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ç„¡åŠ¹åŒ–

**å¿…è¦ãªã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ:**

- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
- `AWS_REGION`
- `S3_BUCKET`
- `CLOUDFRONT_DISTRIBUTION_ID`

## ğŸ“Š æ©Ÿèƒ½ä¸€è¦§

- âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- âœ… ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆLambda + SESï¼‰
- âœ… è¨ªå•è€…ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ï¼ˆLambda + DynamoDBï¼‰
- âœ… HTTPS å¯¾å¿œï¼ˆCloudFront + ACMï¼‰
- âœ… ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³å¯¾å¿œï¼ˆRoute 53ï¼‰
- âœ… è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆGitHub Actionsï¼‰
- âœ… Infrastructure as Codeï¼ˆAWS CDKï¼‰

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- CloudFront ã§ HTTPS å¼·åˆ¶
- API Gateway ã§ CORS è¨­å®š
- IAM ãƒ­ãƒ¼ãƒ«ã§æœ€å°æ¨©é™ã®åŸå‰‡
- ç’°å¢ƒå¤‰æ•°ã§æ©Ÿå¯†æƒ…å ±ã‚’ç®¡ç†
- S3 ãƒã‚±ãƒƒãƒˆã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- CDKã§ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆã‚’æ˜ç¤ºçš„ã«ç®¡ç†

## ğŸ› ï¸ CDKä¾¿åˆ©ã‚³ãƒãƒ³ãƒ‰

```bash
cd cdk

# ã‚¤ãƒ³ãƒ•ãƒ©ã®å·®åˆ†ç¢ºèª
npm run build && cdk diff

# CloudFormationãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
cdk synth

# ãƒ‡ãƒ—ãƒ­ã‚¤
cdk deploy

# ã‚¹ã‚¿ãƒƒã‚¯å‰Šé™¤ï¼ˆæ³¨æ„ï¼šDynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä¿æŒã•ã‚Œã¾ã™ï¼‰
cdk destroy

# ã™ã¹ã¦ã®ã‚¹ã‚¿ãƒƒã‚¯ã‚’ãƒªã‚¹ãƒˆè¡¨ç¤º
cdk list
```

## ğŸ’° ã‚³ã‚¹ãƒˆè©¦ç®—

**æœˆé–“æƒ³å®šã‚³ã‚¹ãƒˆï¼ˆä½ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼‰:**

- S3: ~$0.50
- CloudFront: ~$1.00
- Lambda: ç„¡æ–™æ å†…
- API Gateway: ç„¡æ–™æ å†…
- Route 53: ~$0.50
- SES: ç„¡æ–™æ å†…
- DynamoDB: ç„¡æ–™æ å†…

**åˆè¨ˆ: ç´„ $2-3/æœˆ**

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [AWS CDK Documentation](https://docs.aws.amazon.com/cdk/)
- [AWS CDK Workshop](https://cdkworkshop.com/)

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
